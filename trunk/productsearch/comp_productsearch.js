(function() { 
var AxsJAX=function(useTabKeyFix){this.ID_NUM_=0;this.tabbingStartPosNode=null;this.tabKeyFixOn=false;this.lastFocusedNode=null;this.inputFocused=false;var self=this,focusHandler=function(evt){self.lastFocusedNode=evt.target;if(evt.target.tagName=="INPUT"||evt.target.tagName=="SELECT"||evt.target.tagName=="TEXTAREA")self.inputFocused=true;return true};document.addEventListener("focus",focusHandler,true);var blurHandler=function(evt){self.removeAttributeOf(self.lastFocusedNode,"aria-activedescendant");
self.lastFocusedNode=null;if(evt.target.tagName=="INPUT"||evt.target.tagName=="SELECT"||evt.target.tagName=="TEXTAREA")self.inputFocused=false;return true};document.addEventListener("blur",blurHandler,true);if(useTabKeyFix){this.tabKeyFixOn=true;document.addEventListener("keypress",function(event){self.tabKeyHandler(event,self)},true);document.body.AXSJAX_TABKEYFIX_ADDED=true}this.activeParent=document.body};AxsJAX.prototype.getActiveDocument=function(){var activeDoc=this.activeParent;while(activeDoc.nodeType!=
9)activeDoc=activeDoc.parentNode;return activeDoc};AxsJAX.prototype.speakNode=function(targetNode,opt_noFocusChange){if(!targetNode.id)this.assignId(targetNode);if(opt_noFocusChange){this.setAttributeOf(targetNode,"live","rude");this.setAttributeOf(targetNode,"atomic","true");var activeDoc=this.getActiveDocument(),dummyNode=activeDoc.createElement("div");dummyNode.textContent=" ";dummyNode.name="AxsJAX_dummyNode";if(targetNode.lastChild&&targetNode.lastChild.name&&targetNode.lastChild.name==dummyNode.name)targetNode.removeChild(targetNode.lastChild);
targetNode.appendChild(dummyNode)}else{var oldRole=this.getAttributeOf(targetNode,"role");this.setAttributeOf(targetNode,"role","row");var currentFocusedNode=this.lastFocusedNode;if(!currentFocusedNode||currentFocusedNode.nodeType==9){this.activeParent.tabIndex=-1;currentFocusedNode=this.activeParent}this.setAttributeOf(currentFocusedNode,"activedescendant",null);currentFocusedNode.focus();this.setAttributeOf(currentFocusedNode,"activedescendant",targetNode.id);var self=this;window.setTimeout(function(){if(oldRole)self.setAttributeOf(targetNode,
"role",oldRole);else self.removeAttributeOf(targetNode,"role")},0)}};AxsJAX.prototype.speakTextViaNode=function(textString,opt_anchorNode){var pixelId="AxsJAX_pixelAudioNode",pixelName="AxsJAX_pixelAudioNode",encodedClearPixel="data:image/gif;base64,R0lGODlhAQABAIAAANvf7wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",activeDoc=this.getActiveDocument(),pixelNode=null;if(opt_anchorNode){if(opt_anchorNode.previousSibling&&opt_anchorNode.previousSibling.name==pixelName)pixelNode=opt_anchorNode.previousSibling;
else{pixelNode=activeDoc.createElement("img");pixelNode.name=pixelName;pixelNode.setAttribute("tabindex",0);pixelNode.style.outline="none";pixelNode.src=encodedClearPixel;opt_anchorNode.parentNode.insertBefore(pixelNode,opt_anchorNode);this.forceATSync(pixelNode)}pixelNode.setAttribute("alt",textString);pixelNode.setAttribute("title",textString);window.setTimeout(function(){pixelNode.blur();pixelNode.focus()},0)}else{pixelNode=activeDoc.getElementById(pixelId);if(!pixelNode){pixelNode=activeDoc.createElement("img");
pixelNode.id=pixelId;pixelNode.src=encodedClearPixel;activeDoc.body.appendChild(pixelNode)}pixelNode.setAttribute("alt",textString);pixelNode.setAttribute("title",textString);this.speakNode(pixelNode)}};AxsJAX.prototype.clickElem=function(targetNode,shiftKey){var activeDoc=this.getActiveDocument(),evt=activeDoc.createEvent("MouseEvents");evt.initMouseEvent("mousedown",true,true,activeDoc.defaultView,1,0,0,0,0,false,false,shiftKey,false,0,null);try{targetNode.dispatchEvent(evt)}catch(e){}evt=activeDoc.createEvent("MouseEvents");
evt.initMouseEvent("mouseup",true,true,activeDoc.defaultView,1,0,0,0,0,false,false,shiftKey,false,0,null);try{targetNode.dispatchEvent(evt)}catch(e){}evt=activeDoc.createEvent("MouseEvents");evt.initMouseEvent("click",true,true,activeDoc.defaultView,1,0,0,0,0,false,false,shiftKey,false,0,null);try{targetNode.dispatchEvent(evt)}catch(e){}if(targetNode.tagName=="A"&&targetNode.href&&(targetNode.href.indexOf("http")===0||targetNode.href.indexOf("javascript:")===0))if(shiftKey)window.open(targetNode.href);
else document.location=targetNode.href};AxsJAX.prototype.assignId=function(targetNode,opt_prefixString){if(!targetNode)return"";if(targetNode.id)return targetNode.id;var prefix=opt_prefixString||"AxsJAX_ID_";targetNode.id=prefix+this.ID_NUM_++;return targetNode.id};AxsJAX.prototype.markPosition=function(targetNode){if(!targetNode)return false;if(targetNode.tagName=="A"||targetNode.tagName=="INPUT"){this.tabbingStartPosNode=targetNode;return true}var allDescendants=targetNode.getElementsByTagName("*");
for(var i=0,currentNode;currentNode=allDescendants[i];i++)if(currentNode.tagName=="A"||currentNode.tagName=="INPUT"||currentNode.hasAttribute("tabindex")&&currentNode.tabIndex!=-1){this.tabbingStartPosNode=currentNode;return true}return false};AxsJAX.prototype.tabKeyHandler=function(evt,selfRef){if(!selfRef.tabKeyFixOn)return true;if(evt.keyCode==9&&selfRef.tabbingStartPosNode){selfRef.tabbingStartPosNode.focus();selfRef.tabbingStartPosNode=null}return true};AxsJAX.prototype.goTo=function(targetNode){this.speakNode(targetNode);
targetNode.scrollIntoView(true);this.markPosition(targetNode)};AxsJAX.prototype.setAttributeOf=function(targetNode,attribute,value){if(!targetNode)return;attribute=attribute.toLowerCase();switch(attribute){case "live":attribute="aria-live";break;case "activedescendant":attribute="aria-activedescendant";break;case "atomic":attribute="aria-atomic";break;default:break}targetNode.setAttribute(attribute,value)};AxsJAX.prototype.getAttributeOf=function(targetNode,attribute){return targetNode.getAttribute(attribute)};
AxsJAX.prototype.removeAttributeOf=function(targetNode,attribute){if(targetNode&&targetNode.removeAttribute)targetNode.removeAttribute(attribute)};AxsJAX.prototype.forceATSync=function(targetNode){var id=this.assignId(targetNode),activeDoc=this.getActiveDocument(),loc=activeDoc.baseURI,indexOfHash=loc.indexOf("#");if(indexOfHash!=-1)loc=loc.substring(0,indexOfHash);activeDoc.location=loc+"#"+id};AxsJAX.prototype.evalXPath=function(expression,rootNode){try{var xpathIterator=rootNode.ownerDocument.evaluate(expression,
rootNode,null,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null)}catch(err){return[]}var results=[];for(var xpathNode=xpathIterator.iterateNext();xpathNode;xpathNode=xpathIterator.iterateNext())results.push(xpathNode);return results};var AxsNav=function(axsJAXObj){this.nextListKeys="";this.prevListKeys="";this.navArray=[];this.navListIdx=0;this.navItemIdxs=[];this.lastItem=null;this.targetsArray=[];this.topCharCodeMap={};this.topKeyCodeMap={};this.charCodeMaps=[];this.keyCodeMaps=[];this.axs_=axsJAXObj;this.lens_=null;this.snd_=null;this.LIST_SND="list";this.ITEM_SND="item";this.WRAP_SND="wrap";this.keyHandler=null};AxsNav.str={NEXTLIST:", next list. ",PREVLIST:", previous list. ",GOFORWARD:", go forward. ",GOBACKWARDS:", go backwards. ",
CYCLENEXT:", cycle next. ",CYCLEPREV:", cycle previous. "};AxsNav.prototype.makeItemsArray=function(listNode){var itemsArray=[],cnrItems=listNode.getElementsByTagName("item");for(var i=0,entry;entry=cnrItems[i];i++)try{var xpath=entry.textContent;xpath=xpath.replace(/^\s\s*/,"").replace(/\s\s*$/,"");var htmlElem=this.axs_.getActiveDocument().documentElement,elems=this.axs_.evalXPath(xpath,htmlElem),idxStr=entry.getAttribute("index")||"0",idx=parseInt(idxStr,10),count=elems.length-idx,countStr=entry.getAttribute("count")||
"*";if(countStr!="*")count=parseInt(countStr,10);var end=count+idx,action=entry.getAttribute("action")||null;while(idx<end){var item={};item.action=action;item.elem=elems[idx];if(typeof item.elem!="undefined"){if(typeof item.elem.AxsNavInfo=="undefined")item.elem.AxsNavInfo={};item.elem.AxsNavInfo[this.navArray.length]=itemsArray.length;itemsArray.push(item)}idx++}}catch(err){}return itemsArray};AxsNav.prototype.validateList=function(navList){var valid=true;if(navList.type=="dynamic"&&navList.items.length===
0){if(this.lens_!==null)this.lens_.view(null);navList.items=this.makeItemsArray(navList.cnrNode);navList.targets=this.makeTargetsArray(navList.cnrNode);this.navItemIdxs[this.navListIdx]=-1}if(navList.items.length===0&&navList.entryTarget===null)valid=false;return valid};AxsNav.prototype.doListEntryActions=function(){var currentList=this.currentList(),target=currentList.entryTarget,func=null;if(target!==null){this.actOnTarget(target);func=this.getCallbackFunction(target.action)}if(func===null){this.announceCurrentList();
if(this.snd_!==null)this.snd_.play(this.LIST_SND)}};AxsNav.prototype.nextList=function(){if(this.navArray.length<1)return null;for(var i=0,list;list=this.navArray[i];i++){this.navListIdx++;if(this.navListIdx>=this.navArray.length)this.navListIdx=0;if(this.validateList(this.navArray[this.navListIdx]))break}return this.currentList()};AxsNav.prototype.prevList=function(){if(this.navArray.length<1)return null;for(var i=0,list;list=this.navArray[i];i++){this.navListIdx--;if(this.navListIdx<0)this.navListIdx=
this.navArray.length-1;if(this.validateList(this.navArray[this.navListIdx]))break}return this.currentList()};AxsNav.prototype.currentList=function(){return this.navArray[this.navListIdx]};AxsNav.prototype.announceCurrentList=function(){this.axs_.speakTextViaNode(this.currentList().title)};AxsNav.prototype.nextItem=function(){if(this.navArray.length<1)return null;var currentList=this.navArray[this.navListIdx],items=currentList.items;if(items.length<1)return null;if(this.lastItem){var syncedIndex=this.lastItem.elem.AxsNavInfo[this.navListIdx];
if(typeof syncedIndex!="undefined")this.navItemIdxs[this.navListIdx]=syncedIndex}this.navItemIdxs[this.navListIdx]++;var looped=false;if(this.navItemIdxs[this.navListIdx]>=items.length){this.navItemIdxs[this.navListIdx]=0;looped=true}var itemIndex=this.navItemIdxs[this.navListIdx];if(items[itemIndex].elem.parentNode===null){if(this.lens_!==null)this.lens_.view(null);currentList.items=this.makeItemsArray(currentList.cnrNode);this.navItemIdxs[this.navListIdx]=0;itemIndex=this.navItemIdxs[this.navListIdx]}this.lastItem=
items[itemIndex];if(this.snd_!==null)if(looped)this.snd_.play(this.WRAP_SND);else this.snd_.play(this.ITEM_SND);return this.lastItem};AxsNav.prototype.fwdItem=function(){var list=this.navArray[this.navListIdx],index=this.navItemIdxs[this.navListIdx];if(list.tailTarget!==null&&index+1>=list.items.length){this.actOnTarget(list.tailTarget);this.navItemIdxs[this.navListIdx]=0;return null}var item=this.nextItem();return item};AxsNav.prototype.prevItem=function(){if(this.navArray.length<1)return null;var currentList=
this.navArray[this.navListIdx],items=currentList.items;if(items.length<1)return null;if(this.lastItem){var syncedIndex=this.lastItem.elem.AxsNavInfo[this.navListIdx];if(typeof syncedIndex!="undefined")this.navItemIdxs[this.navListIdx]=syncedIndex}this.navItemIdxs[this.navListIdx]--;var looped=false;if(this.navItemIdxs[this.navListIdx]<0){this.navItemIdxs[this.navListIdx]=items.length-1;looped=true}var itemIndex=this.navItemIdxs[this.navListIdx];if(items[itemIndex].elem.parentNode===null){if(this.lens_!==
null)this.lens_.view(null);currentList.items=this.makeItemsArray(currentList.cnrNode);this.navItemIdxs[this.navListIdx]=currentList.items.length;itemIndex=this.navItemIdxs[this.navListIdx]}this.lastItem=items[itemIndex];if(this.snd_!==null)if(looped)this.snd_.play(this.WRAP_SND);else this.snd_.play(this.ITEM_SND);return this.lastItem};AxsNav.prototype.backItem=function(){var list=this.navArray[this.navListIdx],index=this.navItemIdxs[this.navListIdx];if(list.headTarget!==null&&index-1<=-1){this.actOnTarget(list.headTarget);
this.navItemIdxs[this.navListIdx]=list.items.length;return null}var item=this.prevItem();return item};AxsNav.prototype.currentItem=function(){if(this.navArray.length<1)return null;if(this.lastItem){var syncedIndex=this.lastItem.elem.AxsNavInfo[this.navListIdx];if(typeof syncedIndex!="undefined")this.navItemIdxs[this.navListIdx]=syncedIndex}var currentList=this.navArray[this.navListIdx],items=currentList.items,itemIndex=this.navItemIdxs[this.navListIdx];this.lastItem=items[itemIndex];return this.lastItem};
AxsNav.prototype.getCallbackFunction=function(actionString){var callbackFunc=null;if(actionString!==null&&actionString.indexOf&&actionString.indexOf("CALL:")===0&&actionString.indexOf("(")===-1)try{callbackFunc=eval(actionString.substring(5))}catch(e){}return callbackFunc};AxsNav.prototype.actOnItem=function(item){if(item!==null){var self=this,doAction=function(){var func=self.getCallbackFunction(item.action);if(func)func(item);else{if(self.lens_!==null)self.lens_.view(item.elem);self.axs_.goTo(item.elem)}};
if(this.axs_.lastFocusedNode&&this.axs_.lastFocusedNode.blur){var oldNode=this.axs_.lastFocusedNode;this.axs_.lastFocusedNode=null;if(oldNode.removeAttribute)this.axs_.removeAttributeOf(oldNode,"aria-activedescendant");var tempBlurHandler=function(evt){evt.target.removeEventListener("blur",tempBlurHandler,true);doAction()};oldNode.addEventListener("blur",tempBlurHandler,true);oldNode.blur()}else doAction()}};AxsNav.prototype.assignKeysToMethod=function(keyArray,charMap,keyMap,method){for(var i=0;i<
keyArray.length;i++){var key=keyArray[i];if(key=="LEFT")keyMap[37]=method;else if(key=="UP")keyMap[38]=method;else if(key=="RIGHT")keyMap[39]=method;else if(key=="DOWN")keyMap[40]=method;else if(key=="PGUP")keyMap[33]=method;else if(key=="PGDOWN")keyMap[34]=method;else if(key=="ENTER")keyMap[13]=method;else if(key=="DEL")keyMap[46]=method;else charMap[key.charCodeAt(0)]=method}};AxsNav.prototype.assignItemKeys=function(keyStr,navListIdx,navTaskStr){var keys=[];if(keyStr==="")return;keys=keyStr.split(" ");
var self=this;if(navTaskStr=="prev")this.assignKeysToMethod(keys,this.charCodeMaps[navListIdx],this.keyCodeMaps[navListIdx],function(){self.actOnItem(self.prevItem())});else if(navTaskStr=="next")this.assignKeysToMethod(keys,this.charCodeMaps[navListIdx],this.keyCodeMaps[navListIdx],function(){self.actOnItem(self.nextItem())});else if(navTaskStr=="back")this.assignKeysToMethod(keys,this.charCodeMaps[navListIdx],this.keyCodeMaps[navListIdx],function(){self.actOnItem(self.backItem())});else this.assignKeysToMethod(keys,
this.charCodeMaps[navListIdx],this.keyCodeMaps[navListIdx],function(){self.actOnItem(self.fwdItem())})};AxsNav.prototype.assignHotKeys=function(keyStr,navListIdx,emptyMsg){var keys=[];if(keyStr==="")return;keys=keyStr.split(" ");var self=this;this.assignKeysToMethod(keys,this.topCharCodeMap,this.topKeyCodeMap,function(){if(!self.validateList(self.navArray[navListIdx])){self.axs_.speakTextViaNode(emptyMsg);return}self.navListIdx=navListIdx;self.actOnItem(self.nextItem())})};AxsNav.prototype.assignEmptyMsgKeys=
function(keyStr,emptyMsg){var keys=[];if(keyStr==="")return;keys=keyStr.split(" ");var self=this;this.assignKeysToMethod(keys,this.topCharCodeMap,this.topKeyCodeMap,function(){self.axs_.speakTextViaNode(emptyMsg)})};AxsNav.prototype.assignTargetKeys=function(target,charMap,keyMap){var keys=[];if(target.hotkeyStr==="")return;keys=target.hotkeyStr.split(" ");var self=this;this.assignKeysToMethod(keys,charMap,keyMap,function(){self.actOnTarget(target)})};AxsNav.prototype.actOnTarget=function(target){var xpath=
target.xpath,rootNode=this.axs_.getActiveDocument().documentElement;if(xpath.indexOf(".")===0)rootNode=this.currentItem().elem;var elems=this.axs_.evalXPath(xpath,rootNode);if(elems.length<1)this.axs_.speakTextViaNode(target.emptyMsg);else{var func=this.getCallbackFunction(target.action);if(func){var item={};item.action=target.action;item.elem=elems[0];func(item)}else{this.axs_.clickElem(elems[0],false);elems[0].scrollIntoView(true)}this.axs_.markPosition(elems[0])}};AxsNav.prototype.setUpNavKeys=
function(cnrDOM,emptyLists){var self=this,cnrNode=cnrDOM.firstChild,i;this.topCharCodeMap={};this.topKeyCodeMap={};this.charCodeMaps=[];this.keyCodeMaps=[];var target;for(i=0,target;target=this.targetsArray[i];i++)this.assignTargetKeys(target,this.topCharCodeMap,this.topKeyCodeMap);var keys=[];this.nextListKeys=cnrNode.getAttribute("next")||"";if(this.nextListKeys!=="")keys=this.nextListKeys.split(" ");this.assignKeysToMethod(keys,this.topCharCodeMap,this.topKeyCodeMap,function(){self.nextList();
self.doListEntryActions()});keys=[];this.prevListKeys=cnrNode.getAttribute("prev")||"";if(this.prevListKeys!=="")keys=this.prevListKeys.split(" ");this.assignKeysToMethod(keys,this.topCharCodeMap,this.topKeyCodeMap,function(){self.prevList();self.doListEntryActions()});var list;for(i=0,list;list=this.navArray[i];i++){var charMap={},keyMap={};this.charCodeMaps.push(charMap);this.keyCodeMaps.push(keyMap);this.assignItemKeys(list.nextKeys,i,"next");this.assignItemKeys(list.prevKeys,i,"prev");this.assignItemKeys(list.fwdKeys,
i,"fwd");this.assignItemKeys(list.backKeys,i,"back");this.assignHotKeys(list.hotKeys,i,list.emptyMsg);var j;for(j=0,target;target=list.targets[j];j++)this.assignTargetKeys(target,charMap,keyMap)}var emptyList;for(i=0,emptyList;emptyList=emptyLists[i];i++)this.assignEmptyMsgKeys(emptyList.hotKeys,emptyList.emptyMsg);this.keyHandler=function(evt){if(evt.ctrlKey)return true;if(self.axs_.inputFocused)return true;var idx=self.navListIdx,command=self.keyCodeMaps[idx][evt.keyCode]||self.charCodeMaps[idx][evt.charCode];
if(command)return command();command=self.topKeyCodeMap[evt.keyCode]||self.topCharCodeMap[evt.charCode];if(command)return command()};document.addEventListener("keypress",this.keyHandler,true)};AxsNav.prototype.makeTargetsArray=function(listNode){var targetsArray=[],cnrTargets=listNode.getElementsByTagName("target");for(var i=0,entry;entry=cnrTargets[i];i++){var target={};target.xpath=entry.textContent;target.xpath=target.xpath.replace(/^\s\s*/,"").replace(/\s\s*$/,"");target.title=entry.getAttribute("title")||
"";target.trigger=entry.getAttribute("trigger")||"key";target.hotkeyStr=entry.getAttribute("hotkey")||"";target.action=entry.getAttribute("action")||"click";target.emptyMsg=entry.getAttribute("onEmpty")||"";targetsArray.push(target)}return targetsArray};AxsNav.prototype.navInit=function(cnrString,opt_customNavMethod){var parser=new DOMParser,cnrDOM=parser.parseFromString(cnrString,"text/xml"),lists=cnrDOM.getElementsByTagName("list");this.navArray=[];this.navListIdx=0;this.navItemIdxs=[];var emptyLists=
[],i,currentList;for(i=0,currentList;currentList=lists[i];i++){var navList={};navList.cnrNode=currentList;navList.title=currentList.getAttribute("title")||"";navList.hotKeys=currentList.getAttribute("hotkey")||"";navList.nextKeys=currentList.getAttribute("next")||"";navList.prevKeys=currentList.getAttribute("prev")||"";navList.fwdKeys=currentList.getAttribute("fwd")||"";navList.backKeys=currentList.getAttribute("back")||"";navList.emptyMsg=currentList.getAttribute("onEmpty")||"";navList.type=currentList.getAttribute("type")||
"";navList.tailTarget=null;navList.headTarget=null;navList.entryTarget=null;navList.items=this.makeItemsArray(currentList);navList.targets=this.makeTargetsArray(currentList);for(var j=0,listTarget;listTarget=navList.targets[j];j++)if(listTarget.trigger=="listTail")navList.tailTarget=listTarget;else if(listTarget.trigger=="listHead")navList.headTarget=listTarget;else if(listTarget.trigger=="listEntry")navList.entryTarget=listTarget;if(navList.items.length>0||navList.type=="dynamic"){this.navArray.push(navList);
this.navItemIdxs.push(-1)}else if(navList.hotKeys!=="")emptyLists.push(navList)}this.targetsArray=[];this.targetsIdx=0;var currentNode,cnrNode=cnrDOM.firstChild;for(i=0,currentNode;currentNode=cnrNode.childNodes[i];i++)if(currentNode.tagName=="target"){var target={};target.xpath=currentNode.textContent;target.xpath=target.xpath.replace(/^\s\s*/,"").replace(/\s\s*$/,"");target.title=currentNode.getAttribute("title")||"";target.trigger=currentNode.getAttribute("trigger")||"key";target.hotkeyStr=currentNode.getAttribute("hotkey")||
"";target.action=currentNode.getAttribute("action")||"click";target.emptyMsg=currentNode.getAttribute("onEmpty")||"";this.targetsArray.push(target)}if(this.keyHandler!==null)document.removeEventListener("keypress",this.keyHandler,true);if(opt_customNavMethod===null||typeof opt_customNavMethod=="undefined")this.setUpNavKeys(cnrDOM,emptyLists);else opt_customNavMethod(cnrDOM,this.navArray,emptyLists,this.targetsArray)};AxsNav.prototype.globalHelpString=function(){var helpStr="";if(this.nextListKeys!==
"")helpStr=helpStr+this.nextListKeys+AxsNav.str.NEXTLIST;if(this.prevListKeys!=="")helpStr=helpStr+this.prevListKeys+AxsNav.str.PREVLIST;var i=0,target=null;for(i=0,target;target=this.targetsArray[i];i++)if(target.hotkeyStr!=="")helpStr=helpStr+target.hotkeyStr+", "+target.title+". ";var list=null;for(i=0,list;list=this.navArray[i];i++)if(list.hotKeys!=="")helpStr=helpStr+list.hotKeys+", "+list.title+". ";return helpStr};AxsNav.prototype.localHelpString=function(){var currentList=this.navArray[this.navListIdx],
helpStr="";if(currentList.fwdKeys!=="")helpStr=helpStr+currentList.fwdKeys+AxsNav.str.GOFORWARD;if(currentList.backKeys!=="")helpStr=helpStr+currentList.backKeys+AxsNav.str.GOBACKWARDS;if(currentList.nextKeys!=="")helpStr=helpStr+currentList.nextKeys+AxsNav.str.CYCLENEXT;if(currentList.prevKeys!=="")helpStr=helpStr+currentList.prevKeys+AxsNav.str.CYCLEPREV;for(var i=0,target;target=currentList.targets[i];i++)if(target.hotkeyStr!=="")helpStr=helpStr+target.hotkeyStr+", "+target.title+". ";return helpStr};
AxsNav.prototype.setLens=function(lens){this.lens_=lens};AxsNav.prototype.setSound=function(snd){this.snd_=snd};var AxsSound=function(earconsOnly){var baseURL="http://google-axsjax.googlecode.com/svn/trunk/";this.earconsSwf=baseURL+"common/earcons/axsEarcons.swf?sound=";this.earconsObj=null;this.earconsOnly=earconsOnly;this.sm2BaseURL=baseURL+"thirdparty/soundmanager2/";this.sm2LinkerFrame=null;this.initSucceeded=false;this.verbosity="minimal";this.busyInitializing=false;this.initChecks=0};AxsSound.prototype.init=function(){if(this.earconsOnly)return;if(this.initSucceeded)return;if(this.busyInitializing)return;
this.busyInitializing=true;this.initChecks=0;if(this.sm2LinkerFrame!==null){this.sm2LinkerFrame.parentNode.removeChild(this.sm2LinkerFrame);this.sm2LinkerFrame=null}this.sm2LinkerFrame=document.createElement("iframe");var loc=document.location.toString();if(loc.indexOf("#")!=-1)loc=loc.substring(0,loc.indexOf("#"));this.sm2LinkerFrame.src=this.sm2BaseURL+"AxsJAX_SM2_Linker.html#Verbosity="+this.verbosity+",Parent="+loc;this.sm2LinkerFrame.width="0%";this.sm2LinkerFrame.height="0%";this.sm2LinkerFrame.style.top=
"-1000";this.sm2LinkerFrame.style.left="-1000";this.sm2LinkerFrame.style.position="absolute";document.getElementsByTagName("body")[0].appendChild(this.sm2LinkerFrame);this.checkInitStatus()};AxsSound.prototype.checkInitStatus=function(){if(document.location.hash=="#InitSuccess"){this.initSucceeded=true;this.busyInitializing=false;return}if(this.verbosity=="none"&&this.initChecks>0){this.initSucceeded=true;this.busyInitializing=false;return}var self=this;window.setTimeout(function(){self.checkInitStatus()},
100);this.initChecks++};AxsSound.prototype.play=function(url){var playedEarcon=this.playEarcon(url);if(this.earconsOnly||playedEarcon)return;if(!this.initSucceeded){this.init();var self=this;window.setTimeout(function(){self.play(url)},500);return}this.sm2LinkerFrame.src=this.sm2BaseURL+"AxsJAX_SM2_Linker.html#AxsSoundCmd=Play("+url+")"};AxsSound.prototype.stop=function(){if(this.earconsObj){this.earconsObj.parentNode.removeChild(this.earconsObj);this.earconsObj=null}if(this.earconsOnly)return;if(!this.initSucceeded)return;
this.sm2LinkerFrame.src=this.sm2BaseURL+"AxsJAX_SM2_Linker.html#AxsSoundCmd=Stop()"};AxsSound.prototype.getTime=function(){if(this.earconsOnly)return-1;if(!this.initSucceeded)return-1;var timeKeyword="Time=",timeStr=unescape(document.location.hash);if(timeStr.indexOf(timeKeyword)==-1)return-1;var timeStart=timeStr.indexOf(timeKeyword)+timeKeyword.length,time=parseInt(timeStr.substring(timeStart),10);return time};AxsSound.prototype.playEarcon=function(earcon){var earconCMD="";switch(earcon){case "alert":earconCMD=
"alert";break;case "deselect":earconCMD="deselect";break;case "item":earconCMD="item";break;case "list":earconCMD="list";break;case "select":earconCMD="select";break;case "success":earconCMD="success";break;case "wrap":earconCMD="wrap";break;default:}if(earconCMD==="")return;if(this.earconsObj===null){this.earconsObj=document.createElement("embed");this.earconsObj.height=0;this.earconsObj.width=0;document.body.appendChild(this.earconsObj)}this.earconsObj.src=this.earconsSwf+earconCMD};var AxsLens=function(axsJAXObj){this.multiplier=1.5;var activeDoc=axsJAXObj.getActiveDocument();this.lens=activeDoc.createElement("span");this.lens.style.backgroundColor="#CCE6FF";this.lens.style.borderColor="#0000CC";this.lens.style.borderWidth="medium";this.lens.style.borderStyle="groove";this.lens.style.position="absolute";this.magnifyText();this.lens.style.display="none";activeDoc.body.appendChild(this.lens)};AxsLens.prototype.view=function(targetNode){while(this.lens.firstChild)this.lens.removeChild(this.lens.firstChild);
if(targetNode===null){this.lens.style.display="none";return}var left=0,top=0,obj=targetNode;if(obj.offsetParent){left=obj.offsetLeft;top=obj.offsetTop;obj=obj.offsetParent;while(obj!==null){left+=obj.offsetLeft;top+=obj.offsetTop;obj=obj.offsetParent}}this.lens.appendChild(targetNode.cloneNode(true));this.magnifyText();this.enlargeImages();this.lens.style.top=top+"px";this.lens.style.left=left+"px";this.lens.style.zIndex=999;this.lens.style.display="block"};AxsLens.prototype.setMagnification=function(multiplier){this.multiplier=
multiplier;this.magnifyText();this.enlargeImages()};AxsLens.prototype.enlargeImages=function(){var images=this.lens.getElementsByTagName("img");for(var i=0,image;image=images[i];i++){if(!image.hasAttribute("Axs_OrigHeight")){image.setAttribute("Axs_OrigHeight",image.height);image.setAttribute("Axs_OrigWidth",image.width)}image.height=image.getAttribute("Axs_OrigHeight")*this.multiplier;image.width=image.getAttribute("Axs_OrigWidth")*this.multiplier}};AxsLens.prototype.magnifyText=function(){var fontSizeAdjust=
this.multiplier*0.52;this.lens.style.fontSizeAdjust=fontSizeAdjust};var axsProductSearch={};axsProductSearch.HELP="The following shortcut keys are available. ";axsProductSearch.AVERAGES_OUT_TO_STRING=" averages out to ";axsProductSearch.ACCEPTS_CHECKOUT_STRING=" Accepts Google Checkout. ";axsProductSearch.BUY_THIS_AT_STRING=" Buy this at ";axsProductSearch.BUY_THIS_STRING=" Buy this ";axsProductSearch.axsJAXObj=null;axsProductSearch.axsNavObj=null;axsProductSearch.axsLensObj=null;axsProductSearch.axsSoundObj=null;axsProductSearch.magSize=1.5;axsProductSearch.init=
function(){axsProductSearch.axsJAXObj=new AxsJAX(true);axsProductSearch.axsNavObj=new AxsNav(axsProductSearch.axsJAXObj);axsProductSearch.formatAdAreaSide();document.addEventListener("keypress",axsProductSearch.keyHandler,true);var cnrString='<cnr next="RIGHT l" prev="LEFT h">  <list title="Cycle Results" next="DOWN j" prev="UP k" fwd="n" back="p" hotkey="n">    <item>      /html/body/table[3]/tbody/tr[not(@class)]    </item>    <target title="Next page" trigger="listTail">      //img[contains(@src,"nav_next.gif")]/..    </target>    <target title="Previous page" trigger="listHead">      //img[contains(@src,"G_oogle_arrow.gif")]/..    </target>\t    <target title="Go to result" hotkey="ENTER">      ./td[contains(@class,"ps-rcont")]/a    </target>  </list>  <list title="Sponsored links" next="DOWN j" prev="UP k" hotkey="a">    <item>      id("AXSJAX_SPONSOREDLINKS_SECTION")/span    </item>\t<target title="Go to result" hotkey="ENTER">      .//a    </target>  </list>  <list title="Refine by price" next="DOWN j" prev="UP k">    <item>      id("attr-div")//a[contains(@href,"lnk=prsugg")]    </item>    <target title="Perform refinement" hotkey="ENTER">      .    </target>\t\t<target title = "Display prices" trigger="listEntry">\t  id("attr-div")//a[contains(@href,"lnk=prsugg")]/../following-sibling::li[@class="nav"]/a[contains(text(),"More")]\t</target>  </list>    <list title="Refine by brand" next="DOWN j" prev="UP k">    <item>      id("attr-div")//a[contains(@href,"lnk=brsugg")]    </item>    <target title="Perform refinement" hotkey="ENTER">      .    </target>\t<target title = "Display brands" trigger="listEntry">\t  id("attr-div")//a[contains(@href,"lnk=brsugg")]/../following-sibling::li[@class="nav"]/a[contains(text(),"More")]\t</target>  </list>    <list title="Refine by store" next="DOWN j" prev="UP k">    <item>      id("attr-div")//a[contains(@href,"lnk=storesugg")]    </item>    <target title="Perform refinement" hotkey="ENTER">      .    </target>\t<target title = "Display stores" trigger="listEntry">\t  id("attr-div")//a[contains(@href,"lnk=storesugg")]/../following-sibling::li[@class="nav"]/a[contains(text(),"More")]\t</target>  </list>    <list title="Refine by merchant rating" next="DOWN j" prev="UP k">    <item>      id("attr-div")//a[contains(@href,"lnk=merchant_review")]    </item>    <target title="Perform refinement" hotkey="ENTER">      .    </target>\t<target title = "Display merchant rating" trigger="listEntry">\t  id("attr-div")//a[contains(@href,"lnk=merchant_review")]/../following-sibling::li[@class="nav"]/a[contains(text(),"More")]\t</target>  </list>    <list title="Refine by related searches" next="DOWN j" prev="UP k">    <item>      id("attr-div")//a[contains(@href,"lnk=qsugt")]    </item>    <target title="Perform refinement" hotkey="ENTER">      .    </target>\t<target title = "Display related searches" trigger="listEntry">\t  id("attr-div")//a[contains(@href,"lnk=qsugt")]/../following-sibling::li[@class="nav"]/a[contains(text(),"More")]\t</target>  </list>  </cnr>';
axsProductSearch.axsNavObj.navInit(cnrString,null);axsProductSearch.axsLensObj=new AxsLens(axsProductSearch.axsJAXObj);axsProductSearch.axsNavObj.setLens(axsProductSearch.axsLensObj);axsProductSearch.axsLensObj.setMagnification(axsProductSearch.magSize);axsProductSearch.axsSoundObj=new AxsSound(true);axsProductSearch.axsNavObj.setSound(axsProductSearch.axsSoundObj);window.setTimeout(axsProductSearch.readFirstResult,500)};axsProductSearch.readFirstResult=function(){axsProductSearch.speakResult(axsProductSearch.axsNavObj.nextItem())};
axsProductSearch.speakResult=function(item){var resultRow=item.elem,title=axsProductSearch.getTitle(resultRow),desc=axsProductSearch.getDesc(resultRow),price=axsProductSearch.getPrice(resultRow),seller=axsProductSearch.getSeller(resultRow),ratings=axsProductSearch.getRatings(resultRow),checkout=axsProductSearch.getCheckout(resultRow),message=title+". "+price+". "+desc+seller+". "+ratings+checkout;axsProductSearch.axsLensObj.view(resultRow);resultRow.scrollIntoView(true);axsProductSearch.axsJAXObj.speakTextViaNode(message)};
axsProductSearch.getTitle=function(resultRow){var titleXPath="./td/a[text()]",title=axsProductSearch.axsJAXObj.evalXPath(titleXPath,resultRow)[0];return title.textContent};axsProductSearch.getDesc=function(resultRow){var desc=axsProductSearch.axsJAXObj.evalXPath(".//font",resultRow)[0],descText="";if(!desc){var xpath=".//td[contains(@class,'ps-rcont')]";desc=axsProductSearch.axsJAXObj.evalXPath(xpath,resultRow)[0]}for(var i=0,node;node=desc.childNodes[i];i++)if(node.nodeName=="#text"||node.nodeName==
"B"||node.nodeName=="SPAN")descText=descText+node.textContent;return descText};axsProductSearch.getPrice=function(resultRow){var priceXPath=".//b[contains(@class,'ps-larger-t')]",price=axsProductSearch.axsJAXObj.evalXPath(priceXPath,resultRow)[0];return price.textContent};axsProductSearch.getSeller=function(resultRow){var sellerXPath=".//nobr/a",seller=axsProductSearch.axsJAXObj.evalXPath(sellerXPath,resultRow)[0];if(seller)return axsProductSearch.BUY_THIS_AT_STRING+seller.textContent;else{var xpath=
".//b[contains(@class,'ps-larger-t')]/../..",priceArea=axsProductSearch.axsJAXObj.evalXPath(xpath,resultRow)[0],storeCount=priceArea.childNodes[3];return axsProductSearch.BUY_THIS_STRING+storeCount.textContent}};axsProductSearch.getRatings=function(resultRow){var starXP=".//nobr/a/img[contains(@src,'star')]",star=axsProductSearch.axsJAXObj.evalXPath(starXP,resultRow)[0],ratedByXP=".//nobr/a[contains(text(),'ratings')]",ratedBy=axsProductSearch.axsJAXObj.evalXPath(ratedByXP,resultRow)[0],ratings="";
if(star)ratings=ratedBy.textContent+axsProductSearch.AVERAGES_OUT_TO_STRING+star.alt+". ";return ratings};axsProductSearch.getCheckout=function(resultRow){var xpath=".//a[contains(@class,'checkout')]",checkout=axsProductSearch.axsJAXObj.evalXPath(xpath,resultRow)[0];if(checkout)return axsProductSearch.ACCEPTS_CHECKOUT_STRING;return""};axsProductSearch.formatAdAreaSide=function(){var xpath='//font[@class="s"]/..',adArea=axsProductSearch.axsJAXObj.evalXPath(xpath,document.body)[0];if(!adArea)return;
xpath='//font[@class="s"]/../font';var adAreaElems=axsProductSearch.axsJAXObj.evalXPath(xpath,document.body),adElemCount=adAreaElems.length,adCount=adElemCount/3;if(adAreaElems.length%3!=0)return;var reformattedAds=[],i=0,brElem=window.content.document.createElement("br");for(i=0;i<adElemCount;i=i+3){var adSpan=window.content.document.createElement("span");adSpan.appendChild(adAreaElems[i].cloneNode(true));adSpan.appendChild(brElem.cloneNode(true));adSpan.appendChild(adAreaElems[i+1].cloneNode(true));
adSpan.appendChild(brElem.cloneNode(true));adSpan.appendChild(adAreaElems[i+2].cloneNode(true));adSpan.appendChild(brElem.cloneNode(true));adSpan.appendChild(brElem.cloneNode(true));reformattedAds.push(adSpan)}while(adArea.firstChild)adArea.removeChild(adArea.firstChild);for(i=0;i<adCount;i++)adArea.appendChild(reformattedAds[i]);adArea.id="AXSJAX_SPONSOREDLINKS_SECTION"};axsProductSearch.keyHandler=function(evt){if(evt.ctrlKey)return true;if(evt.keyCode==27){axsProductSearch.axsJAXObj.lastFocusedNode.blur();
return false}if(axsProductSearch.axsJAXObj.inputFocused)return true;var command=axsProductSearch.keyCodeMap[evt.keyCode]||axsProductSearch.charCodeMap[evt.charCode];if(command)return command();return true};axsProductSearch.keyCodeMap={};axsProductSearch.charCodeMap={47:function(){document.getElementsByName("q")[0].focus();document.getElementsByName("q")[0].select();return false},63:function(){var helpStr=axsProductSearch.HELP+axsProductSearch.axsNavObj.localHelpString()+axsProductSearch.axsNavObj.globalHelpString();
axsProductSearch.axsJAXObj.speakTextViaNode(helpStr);return false}};axsProductSearch.init();
 })();
