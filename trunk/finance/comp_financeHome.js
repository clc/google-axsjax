(function() { 
var AxsJAX=function(useTabKeyFix){this.ID_NUM_=0;this.tabbingStartPosNode=null;this.tabKeyFixOn=false;this.lastFocusedNode=null;this.inputFocused=false;var self=this,focusHandler=function(evt){self.lastFocusedNode=evt.target;if(evt.target.tagName=="INPUT"||evt.target.tagName=="SELECT"||evt.target.tagName=="TEXTAREA")self.inputFocused=true;return true};document.addEventListener("focus",focusHandler,true);var blurHandler=function(evt){self.removeAttributeOf(self.lastFocusedNode,"aria-activedescendant");
self.lastFocusedNode=null;if(evt.target.tagName=="INPUT"||evt.target.tagName=="SELECT"||evt.target.tagName=="TEXTAREA")self.inputFocused=false;return true};document.addEventListener("blur",blurHandler,true);if(useTabKeyFix){this.tabKeyFixOn=true;document.addEventListener("keypress",function(event){self.tabKeyHandler(event,self)},true);document.body.AXSJAX_TABKEYFIX_ADDED=true}this.activeParent=document.body};AxsJAX.prototype.getActiveDocument=function(){var activeDoc=this.activeParent;while(activeDoc.nodeType!=
9)activeDoc=activeDoc.parentNode;return activeDoc};AxsJAX.prototype.speakNode=function(targetNode,opt_noFocusChange){targetNode.id||this.assignId(targetNode);if(opt_noFocusChange){this.setAttributeOf(targetNode,"live","rude");this.setAttributeOf(targetNode,"atomic","true");var activeDoc=this.getActiveDocument(),dummyNode=activeDoc.createElement("div");dummyNode.textContent=" ";dummyNode.name="AxsJAX_dummyNode";targetNode.lastChild&&targetNode.lastChild.name&&targetNode.lastChild.name==dummyNode.name&&
targetNode.removeChild(targetNode.lastChild);targetNode.appendChild(dummyNode)}else{var oldRole=this.getAttributeOf(targetNode,"role");this.setAttributeOf(targetNode,"role","row");var currentFocusedNode=this.lastFocusedNode;if(!currentFocusedNode||currentFocusedNode.nodeType==9){this.activeParent.tabIndex=-1;currentFocusedNode=this.activeParent}this.setAttributeOf(currentFocusedNode,"activedescendant",null);currentFocusedNode.focus();this.setAttributeOf(currentFocusedNode,"activedescendant",targetNode.id);
var self=this;window.setTimeout(function(){oldRole?self.setAttributeOf(targetNode,"role",oldRole):self.removeAttributeOf(targetNode,"role")},0)}};AxsJAX.prototype.speakTextViaNode=function(textString,opt_anchorNode){var pixelId="AxsJAX_pixelAudioNode",pixelName="AxsJAX_pixelAudioNode",encodedClearPixel="data:image/gif;base64,R0lGODlhAQABAIAAANvf7wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",activeDoc=this.getActiveDocument(),pixelNode=null;if(opt_anchorNode){if(opt_anchorNode.previousSibling&&opt_anchorNode.previousSibling.name==
pixelName)pixelNode=opt_anchorNode.previousSibling;else{pixelNode=activeDoc.createElement("img");pixelNode.name=pixelName;pixelNode.setAttribute("tabindex",0);pixelNode.style.outline="none";pixelNode.src=encodedClearPixel;opt_anchorNode.parentNode.insertBefore(pixelNode,opt_anchorNode);this.forceATSync(pixelNode)}pixelNode.setAttribute("alt",textString);pixelNode.setAttribute("title",textString);window.setTimeout(function(){pixelNode.blur();pixelNode.focus()},0)}else{pixelNode=activeDoc.getElementById(pixelId);
if(!pixelNode){pixelNode=activeDoc.createElement("img");pixelNode.id=pixelId;pixelNode.src=encodedClearPixel;activeDoc.body.appendChild(pixelNode)}pixelNode.setAttribute("alt",textString);pixelNode.setAttribute("title",textString);this.speakNode(pixelNode)}};AxsJAX.prototype.clickElem=function(targetNode,shiftKey){var activeDoc=this.getActiveDocument(),evt=activeDoc.createEvent("MouseEvents");evt.initMouseEvent("mousedown",true,true,activeDoc.defaultView,1,0,0,0,0,false,false,shiftKey,false,0,null);
try{targetNode.dispatchEvent(evt)}catch(e){}evt=activeDoc.createEvent("MouseEvents");evt.initMouseEvent("mouseup",true,true,activeDoc.defaultView,1,0,0,0,0,false,false,shiftKey,false,0,null);try{targetNode.dispatchEvent(evt)}catch(e){}evt=activeDoc.createEvent("MouseEvents");evt.initMouseEvent("click",true,true,activeDoc.defaultView,1,0,0,0,0,false,false,shiftKey,false,0,null);try{targetNode.dispatchEvent(evt)}catch(e){}if(targetNode.tagName=="A"&&targetNode.href&&(targetNode.href.indexOf("http")===
0||targetNode.href.indexOf("javascript:")===0))if(shiftKey)window.open(targetNode.href);else document.location=targetNode.href};AxsJAX.prototype.assignId=function(targetNode,opt_prefixString){if(!targetNode)return"";if(targetNode.id)return targetNode.id;var prefix=opt_prefixString||"AxsJAX_ID_";targetNode.id=prefix+this.ID_NUM_++;return targetNode.id};AxsJAX.prototype.markPosition=function(targetNode){if(!targetNode)return false;if(targetNode.tagName=="A"||targetNode.tagName=="INPUT"){this.tabbingStartPosNode=
targetNode;return true}var allDescendants=targetNode.getElementsByTagName("*");for(var i=0,currentNode;currentNode=allDescendants[i];i++)if(currentNode.tagName=="A"||currentNode.tagName=="INPUT"||currentNode.hasAttribute("tabindex")&&currentNode.tabIndex!=-1){this.tabbingStartPosNode=currentNode;return true}return false};AxsJAX.prototype.tabKeyHandler=function(evt,selfRef){if(!selfRef.tabKeyFixOn)return true;if(evt.keyCode==9&&selfRef.tabbingStartPosNode){selfRef.tabbingStartPosNode.focus();selfRef.tabbingStartPosNode=
null}return true};AxsJAX.prototype.goTo=function(targetNode){this.speakNode(targetNode);targetNode.scrollIntoView(true);this.markPosition(targetNode)};AxsJAX.prototype.setAttributeOf=function(targetNode,attribute,value){if(!targetNode)return;attribute=attribute.toLowerCase();switch(attribute){case "live":attribute="aria-live";break;case "activedescendant":attribute="aria-activedescendant";break;case "atomic":attribute="aria-atomic";break;default:break}targetNode.setAttribute(attribute,value)};AxsJAX.prototype.getAttributeOf=
function(targetNode,attribute){return targetNode.getAttribute(attribute)};AxsJAX.prototype.removeAttributeOf=function(targetNode,attribute){targetNode&&targetNode.removeAttribute&&targetNode.removeAttribute(attribute)};AxsJAX.prototype.forceATSync=function(targetNode){var id=this.assignId(targetNode),activeDoc=this.getActiveDocument(),loc=activeDoc.baseURI,indexOfHash=loc.indexOf("#");if(indexOfHash!=-1)loc=loc.substring(0,indexOfHash);activeDoc.location=loc+"#"+id};AxsJAX.prototype.evalXPath=function(expression,
rootNode){try{var xpathIterator=rootNode.ownerDocument.evaluate(expression,rootNode,null,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null)}catch(err){return[]}var results=[];for(var xpathNode=xpathIterator.iterateNext();xpathNode;xpathNode=xpathIterator.iterateNext())results.push(xpathNode);return results};var AxsNav=function(axsJAXObj){this.nextListKeys="";this.prevListKeys="";this.navArray=[];this.navListIdx=0;this.navItemIdxs=[];this.lastItem=null;this.targetsArray=[];this.topCharCodeMap={};this.topKeyCodeMap={};this.charCodeMaps=[];this.keyCodeMaps=[];this.axs_=axsJAXObj;this.lens_=null;this.snd_=null;this.LIST_SND="list";this.ITEM_SND="item";this.WRAP_SND="wrap";this.keyHandler=null};AxsNav.str={NEXTLIST:", next list. ",PREVLIST:", previous list. ",GOFORWARD:", go forward. ",GOBACKWARDS:", go backwards. ",
CYCLENEXT:", cycle next. ",CYCLEPREV:", cycle previous. "};AxsNav.prototype.makeItemsArray=function(listNode){var itemsArray=[],cnrItems=listNode.getElementsByTagName("item");for(var i=0,entry;entry=cnrItems[i];i++)try{var xpath=entry.textContent;xpath=xpath.replace(/^\s\s*/,"").replace(/\s\s*$/,"");var htmlElem=this.axs_.getActiveDocument().documentElement,elems=this.axs_.evalXPath(xpath,htmlElem),idxStr=entry.getAttribute("index")||"0",idx=parseInt(idxStr,10),count=elems.length-idx,countStr=entry.getAttribute("count")||
"*";if(countStr!="*")count=parseInt(countStr,10);var end=count+idx,action=entry.getAttribute("action")||null;while(idx<end){var item={};item.action=action;item.elem=elems[idx];if(typeof item.elem!="undefined"){if(typeof item.elem.AxsNavInfo=="undefined")item.elem.AxsNavInfo={};item.elem.AxsNavInfo[this.navArray.length]=itemsArray.length;itemsArray.push(item)}idx++}}catch(err){}return itemsArray};AxsNav.prototype.validateList=function(navList){var valid=true;if(navList.type=="dynamic"&&navList.items.length===
0){this.lens_!==null&&this.lens_.view(null);navList.items=this.makeItemsArray(navList.cnrNode);navList.targets=this.makeTargetsArray(navList.cnrNode);this.navItemIdxs[this.navListIdx]=-1}if(navList.items.length===0&&navList.entryTarget===null)valid=false;return valid};AxsNav.prototype.doListEntryActions=function(){var currentList=this.currentList(),target=currentList.entryTarget,func=null;if(target!==null){this.actOnTarget(target);func=this.getCallbackFunction(target.action)}if(func===null){this.announceCurrentList();
this.snd_!==null&&this.snd_.play(this.LIST_SND)}};AxsNav.prototype.nextList=function(){if(this.navArray.length<1)return null;for(var i=0,list;list=this.navArray[i];i++){this.navListIdx++;if(this.navListIdx>=this.navArray.length)this.navListIdx=0;if(this.validateList(this.navArray[this.navListIdx]))break}return this.currentList()};AxsNav.prototype.prevList=function(){if(this.navArray.length<1)return null;for(var i=0,list;list=this.navArray[i];i++){this.navListIdx--;if(this.navListIdx<0)this.navListIdx=
this.navArray.length-1;if(this.validateList(this.navArray[this.navListIdx]))break}return this.currentList()};AxsNav.prototype.currentList=function(){return this.navArray[this.navListIdx]};AxsNav.prototype.announceCurrentList=function(){this.axs_.speakTextViaNode(this.currentList().title)};AxsNav.prototype.nextItem=function(){if(this.navArray.length<1)return null;var currentList=this.navArray[this.navListIdx],items=currentList.items;if(items.length<1)return null;if(this.lastItem){var syncedIndex=this.lastItem.elem.AxsNavInfo[this.navListIdx];
if(typeof syncedIndex!="undefined")this.navItemIdxs[this.navListIdx]=syncedIndex}this.navItemIdxs[this.navListIdx]++;var looped=false;if(this.navItemIdxs[this.navListIdx]>=items.length){this.navItemIdxs[this.navListIdx]=0;looped=true}var itemIndex=this.navItemIdxs[this.navListIdx];if(items[itemIndex].elem.parentNode===null){this.lens_!==null&&this.lens_.view(null);currentList.items=this.makeItemsArray(currentList.cnrNode);this.navItemIdxs[this.navListIdx]=0;itemIndex=this.navItemIdxs[this.navListIdx]}this.lastItem=
items[itemIndex];if(this.snd_!==null)looped?this.snd_.play(this.WRAP_SND):this.snd_.play(this.ITEM_SND);return this.lastItem};AxsNav.prototype.fwdItem=function(){var list=this.navArray[this.navListIdx],index=this.navItemIdxs[this.navListIdx];if(list.tailTarget!==null&&index+1>=list.items.length){this.actOnTarget(list.tailTarget);this.navItemIdxs[this.navListIdx]=0;return null}var item=this.nextItem();return item};AxsNav.prototype.prevItem=function(){if(this.navArray.length<1)return null;var currentList=
this.navArray[this.navListIdx],items=currentList.items;if(items.length<1)return null;if(this.lastItem){var syncedIndex=this.lastItem.elem.AxsNavInfo[this.navListIdx];if(typeof syncedIndex!="undefined")this.navItemIdxs[this.navListIdx]=syncedIndex}this.navItemIdxs[this.navListIdx]--;var looped=false;if(this.navItemIdxs[this.navListIdx]<0){this.navItemIdxs[this.navListIdx]=items.length-1;looped=true}var itemIndex=this.navItemIdxs[this.navListIdx];if(items[itemIndex].elem.parentNode===null){this.lens_!==
null&&this.lens_.view(null);currentList.items=this.makeItemsArray(currentList.cnrNode);this.navItemIdxs[this.navListIdx]=currentList.items.length;itemIndex=this.navItemIdxs[this.navListIdx]}this.lastItem=items[itemIndex];if(this.snd_!==null)looped?this.snd_.play(this.WRAP_SND):this.snd_.play(this.ITEM_SND);return this.lastItem};AxsNav.prototype.backItem=function(){var list=this.navArray[this.navListIdx],index=this.navItemIdxs[this.navListIdx];if(list.headTarget!==null&&index-1<=-1){this.actOnTarget(list.headTarget);
this.navItemIdxs[this.navListIdx]=list.items.length;return null}var item=this.prevItem();return item};AxsNav.prototype.currentItem=function(){if(this.navArray.length<1)return null;if(this.lastItem){var syncedIndex=this.lastItem.elem.AxsNavInfo[this.navListIdx];if(typeof syncedIndex!="undefined")this.navItemIdxs[this.navListIdx]=syncedIndex}var currentList=this.navArray[this.navListIdx],items=currentList.items,itemIndex=this.navItemIdxs[this.navListIdx];this.lastItem=items[itemIndex];return this.lastItem};
AxsNav.prototype.getCallbackFunction=function(actionString){var callbackFunc=null;if(actionString!==null&&actionString.indexOf&&actionString.indexOf("CALL:")===0&&actionString.indexOf("(")===-1)try{callbackFunc=eval(actionString.substring(5))}catch(e){}return callbackFunc};AxsNav.prototype.actOnItem=function(item){if(item!==null){var self=this,doAction=function(){var func=self.getCallbackFunction(item.action);if(func)func(item);else{self.lens_!==null&&self.lens_.view(item.elem);self.axs_.goTo(item.elem)}};
if(this.axs_.lastFocusedNode&&this.axs_.lastFocusedNode.blur){var oldNode=this.axs_.lastFocusedNode;this.axs_.lastFocusedNode=null;oldNode.removeAttribute&&this.axs_.removeAttributeOf(oldNode,"aria-activedescendant");var tempBlurHandler=function(evt){evt.target.removeEventListener("blur",tempBlurHandler,true);doAction()};oldNode.addEventListener("blur",tempBlurHandler,true);oldNode.blur()}else doAction()}};AxsNav.prototype.assignKeysToMethod=function(keyArray,charMap,keyMap,method){for(var i=0;i<
keyArray.length;i++){var key=keyArray[i];if(key=="LEFT")keyMap[37]=method;else if(key=="UP")keyMap[38]=method;else if(key=="RIGHT")keyMap[39]=method;else if(key=="DOWN")keyMap[40]=method;else if(key=="PGUP")keyMap[33]=method;else if(key=="PGDOWN")keyMap[34]=method;else if(key=="ENTER")keyMap[13]=method;else if(key=="DEL")keyMap[46]=method;else charMap[key.charCodeAt(0)]=method}};AxsNav.prototype.assignItemKeys=function(keyStr,navListIdx,navTaskStr){var keys=[];if(keyStr==="")return;keys=keyStr.split(" ");
var self=this;if(navTaskStr=="prev")this.assignKeysToMethod(keys,this.charCodeMaps[navListIdx],this.keyCodeMaps[navListIdx],function(){self.actOnItem(self.prevItem())});else if(navTaskStr=="next")this.assignKeysToMethod(keys,this.charCodeMaps[navListIdx],this.keyCodeMaps[navListIdx],function(){self.actOnItem(self.nextItem())});else navTaskStr=="back"?this.assignKeysToMethod(keys,this.charCodeMaps[navListIdx],this.keyCodeMaps[navListIdx],function(){self.actOnItem(self.backItem())}):this.assignKeysToMethod(keys,
this.charCodeMaps[navListIdx],this.keyCodeMaps[navListIdx],function(){self.actOnItem(self.fwdItem())})};AxsNav.prototype.assignHotKeys=function(keyStr,navListIdx,emptyMsg){var keys=[];if(keyStr==="")return;keys=keyStr.split(" ");var self=this;this.assignKeysToMethod(keys,this.topCharCodeMap,this.topKeyCodeMap,function(){if(!self.validateList(self.navArray[navListIdx])){self.axs_.speakTextViaNode(emptyMsg);return}self.navListIdx=navListIdx;self.actOnItem(self.nextItem())})};AxsNav.prototype.assignEmptyMsgKeys=
function(keyStr,emptyMsg){var keys=[];if(keyStr==="")return;keys=keyStr.split(" ");var self=this;this.assignKeysToMethod(keys,this.topCharCodeMap,this.topKeyCodeMap,function(){self.axs_.speakTextViaNode(emptyMsg)})};AxsNav.prototype.assignTargetKeys=function(target,charMap,keyMap){var keys=[];if(target.hotkeyStr==="")return;keys=target.hotkeyStr.split(" ");var self=this;this.assignKeysToMethod(keys,charMap,keyMap,function(){self.actOnTarget(target)})};AxsNav.prototype.actOnTarget=function(target){var xpath=
target.xpath,rootNode=this.axs_.getActiveDocument().documentElement;if(xpath.indexOf(".")===0)rootNode=this.currentItem().elem;var elems=this.axs_.evalXPath(xpath,rootNode);if(elems.length<1)this.axs_.speakTextViaNode(target.emptyMsg);else{var func=this.getCallbackFunction(target.action);if(func){var item={};item.action=target.action;item.elem=elems[0];func(item)}else{this.axs_.clickElem(elems[0],false);elems[0].scrollIntoView(true)}this.axs_.markPosition(elems[0])}};AxsNav.prototype.setUpNavKeys=
function(cnrDOM,emptyLists){var self=this,cnrNode=cnrDOM.firstChild,i;this.topCharCodeMap={};this.topKeyCodeMap={};this.charCodeMaps=[];this.keyCodeMaps=[];var target;for(i=0,target;target=this.targetsArray[i];i++)this.assignTargetKeys(target,this.topCharCodeMap,this.topKeyCodeMap);var keys=[];this.nextListKeys=cnrNode.getAttribute("next")||"";if(this.nextListKeys!=="")keys=this.nextListKeys.split(" ");this.assignKeysToMethod(keys,this.topCharCodeMap,this.topKeyCodeMap,function(){self.nextList();
self.doListEntryActions()});keys=[];this.prevListKeys=cnrNode.getAttribute("prev")||"";if(this.prevListKeys!=="")keys=this.prevListKeys.split(" ");this.assignKeysToMethod(keys,this.topCharCodeMap,this.topKeyCodeMap,function(){self.prevList();self.doListEntryActions()});var list;for(i=0,list;list=this.navArray[i];i++){var charMap={},keyMap={};this.charCodeMaps.push(charMap);this.keyCodeMaps.push(keyMap);this.assignItemKeys(list.nextKeys,i,"next");this.assignItemKeys(list.prevKeys,i,"prev");this.assignItemKeys(list.fwdKeys,
i,"fwd");this.assignItemKeys(list.backKeys,i,"back");this.assignHotKeys(list.hotKeys,i,list.emptyMsg);var j;for(j=0,target;target=list.targets[j];j++)this.assignTargetKeys(target,charMap,keyMap)}var emptyList;for(i=0,emptyList;emptyList=emptyLists[i];i++)this.assignEmptyMsgKeys(emptyList.hotKeys,emptyList.emptyMsg);this.keyHandler=function(evt){if(evt.ctrlKey)return true;if(self.axs_.inputFocused)return true;var idx=self.navListIdx;if(idx<self.keyCodeMaps.length){var command=self.keyCodeMaps[idx][evt.keyCode]||
self.charCodeMaps[idx][evt.charCode];if(command)return command()}command=self.topKeyCodeMap[evt.keyCode]||self.topCharCodeMap[evt.charCode];if(command)return command()};document.addEventListener("keypress",this.keyHandler,true)};AxsNav.prototype.makeTargetsArray=function(listNode){var targetsArray=[],cnrTargets=listNode.getElementsByTagName("target");for(var i=0,entry;entry=cnrTargets[i];i++){var target={};target.xpath=entry.textContent;target.xpath=target.xpath.replace(/^\s\s*/,"").replace(/\s\s*$/,
"");target.title=entry.getAttribute("title")||"";target.trigger=entry.getAttribute("trigger")||"key";target.hotkeyStr=entry.getAttribute("hotkey")||"";target.action=entry.getAttribute("action")||"click";target.emptyMsg=entry.getAttribute("onEmpty")||"";targetsArray.push(target)}return targetsArray};AxsNav.prototype.navInit=function(cnrString,opt_customNavMethod){var parser=new DOMParser,cnrDOM=parser.parseFromString(cnrString,"text/xml"),lists=cnrDOM.getElementsByTagName("list");this.navArray=[];
this.navListIdx=0;this.navItemIdxs=[];var emptyLists=[],i,currentList;for(i=0,currentList;currentList=lists[i];i++){var navList={};navList.cnrNode=currentList;navList.title=currentList.getAttribute("title")||"";navList.hotKeys=currentList.getAttribute("hotkey")||"";navList.nextKeys=currentList.getAttribute("next")||"";navList.prevKeys=currentList.getAttribute("prev")||"";navList.fwdKeys=currentList.getAttribute("fwd")||"";navList.backKeys=currentList.getAttribute("back")||"";navList.emptyMsg=currentList.getAttribute("onEmpty")||
"";navList.type=currentList.getAttribute("type")||"";navList.tailTarget=null;navList.headTarget=null;navList.entryTarget=null;navList.items=this.makeItemsArray(currentList);navList.targets=this.makeTargetsArray(currentList);for(var j=0,listTarget;listTarget=navList.targets[j];j++)if(listTarget.trigger=="listTail")navList.tailTarget=listTarget;else if(listTarget.trigger=="listHead")navList.headTarget=listTarget;else if(listTarget.trigger=="listEntry")navList.entryTarget=listTarget;if(navList.items.length>
0||navList.type=="dynamic"){this.navArray.push(navList);this.navItemIdxs.push(-1)}else navList.hotKeys!==""&&emptyLists.push(navList)}this.targetsArray=[];this.targetsIdx=0;var currentNode,cnrNode=cnrDOM.firstChild;for(i=0,currentNode;currentNode=cnrNode.childNodes[i];i++)if(currentNode.tagName=="target"){var target={};target.xpath=currentNode.textContent;target.xpath=target.xpath.replace(/^\s\s*/,"").replace(/\s\s*$/,"");target.title=currentNode.getAttribute("title")||"";target.trigger=currentNode.getAttribute("trigger")||
"key";target.hotkeyStr=currentNode.getAttribute("hotkey")||"";target.action=currentNode.getAttribute("action")||"click";target.emptyMsg=currentNode.getAttribute("onEmpty")||"";this.targetsArray.push(target)}this.keyHandler!==null&&document.removeEventListener("keypress",this.keyHandler,true);opt_customNavMethod===null||typeof opt_customNavMethod=="undefined"?this.setUpNavKeys(cnrDOM,emptyLists):opt_customNavMethod(cnrDOM,this.navArray,emptyLists,this.targetsArray)};AxsNav.prototype.globalHelpString=
function(){var helpStr="";if(this.nextListKeys!=="")helpStr=helpStr+this.nextListKeys+AxsNav.str.NEXTLIST;if(this.prevListKeys!=="")helpStr=helpStr+this.prevListKeys+AxsNav.str.PREVLIST;var i=0,target=null;for(i=0,target;target=this.targetsArray[i];i++)if(target.hotkeyStr!=="")helpStr=helpStr+target.hotkeyStr+", "+target.title+". ";var list=null;for(i=0,list;list=this.navArray[i];i++)if(list.hotKeys!=="")helpStr=helpStr+list.hotKeys+", "+list.title+". ";return helpStr};AxsNav.prototype.localHelpString=
function(){var currentList=this.navArray[this.navListIdx],helpStr="";if(currentList.fwdKeys!=="")helpStr=helpStr+currentList.fwdKeys+AxsNav.str.GOFORWARD;if(currentList.backKeys!=="")helpStr=helpStr+currentList.backKeys+AxsNav.str.GOBACKWARDS;if(currentList.nextKeys!=="")helpStr=helpStr+currentList.nextKeys+AxsNav.str.CYCLENEXT;if(currentList.prevKeys!=="")helpStr=helpStr+currentList.prevKeys+AxsNav.str.CYCLEPREV;for(var i=0,target;target=currentList.targets[i];i++)if(target.hotkeyStr!=="")helpStr=
helpStr+target.hotkeyStr+", "+target.title+". ";return helpStr};AxsNav.prototype.setLens=function(lens){this.lens_=lens};AxsNav.prototype.setSound=function(snd){this.snd_=snd};AxsNav.prototype.refreshList=function(listTitle){if(listTitle===null)return false;var reloaded=false;for(var i=0,navList;navList=this.navArray[i];i++)if(navList.title==listTitle){navList.items=[];navList.targets=[];reloaded=this.validateList(navList);break}return reloaded};var AxsLens=function(axsJAXObj){this.multiplier=1.5;var activeDoc=axsJAXObj.getActiveDocument();this.lens=activeDoc.createElement("span");this.lens.style.backgroundColor="#CCE6FF";this.lens.style.borderColor="#0000CC";this.lens.style.borderWidth="medium";this.lens.style.borderStyle="groove";this.lens.style.position="absolute";this.magnifyText();this.lens.style.display="none";activeDoc.body.appendChild(this.lens)};AxsLens.prototype.view=function(targetNode){while(this.lens.firstChild)this.lens.removeChild(this.lens.firstChild);
if(targetNode===null){this.lens.style.display="none";return}var left=0,top=0,obj=targetNode;if(obj.offsetParent){left=obj.offsetLeft;top=obj.offsetTop;obj=obj.offsetParent;while(obj!==null){left+=obj.offsetLeft;top+=obj.offsetTop;obj=obj.offsetParent}}this.lens.appendChild(targetNode.cloneNode(true));this.magnifyText();this.enlargeImages();this.lens.style.top=top+"px";this.lens.style.left=left+"px";this.lens.style.zIndex=999;this.lens.style.display="block"};AxsLens.prototype.setMagnification=function(multiplier){this.multiplier=
multiplier;this.magnifyText();this.enlargeImages()};AxsLens.prototype.enlargeImages=function(){var images=this.lens.getElementsByTagName("img");for(var i=0,image;image=images[i];i++){if(!image.hasAttribute("Axs_OrigHeight")){image.setAttribute("Axs_OrigHeight",image.height);image.setAttribute("Axs_OrigWidth",image.width)}image.height=image.getAttribute("Axs_OrigHeight")*this.multiplier;image.width=image.getAttribute("Axs_OrigWidth")*this.multiplier}};AxsLens.prototype.magnifyText=function(){var fontSizeAdjust=
this.multiplier*0.52;this.lens.style.fontSizeAdjust=fontSizeAdjust};var AxsSound=function(earconsOnly){var baseURL="http://google-axsjax.googlecode.com/svn/trunk/";this.earconsSwf=baseURL+"common/earcons/axsEarcons.swf?sound=";this.earconsObj=null;this.earconsOnly=earconsOnly;this.sm2BaseURL=baseURL+"thirdparty/soundmanager2/";this.sm2LinkerFrame=null;this.initSucceeded=false;this.verbosity="minimal";this.busyInitializing=false;this.initChecks=0};AxsSound.prototype.init=function(){if(this.earconsOnly)return;if(this.initSucceeded)return;if(this.busyInitializing)return;
this.busyInitializing=true;this.initChecks=0;if(this.sm2LinkerFrame!==null){this.sm2LinkerFrame.parentNode.removeChild(this.sm2LinkerFrame);this.sm2LinkerFrame=null}this.sm2LinkerFrame=document.createElement("iframe");var loc=document.location.toString();if(loc.indexOf("#")!=-1)loc=loc.substring(0,loc.indexOf("#"));this.sm2LinkerFrame.src=this.sm2BaseURL+"AxsJAX_SM2_Linker.html#Verbosity="+this.verbosity+",Parent="+loc;this.sm2LinkerFrame.width="0%";this.sm2LinkerFrame.height="0%";this.sm2LinkerFrame.style.top=
"-1000";this.sm2LinkerFrame.style.left="-1000";this.sm2LinkerFrame.style.position="absolute";document.getElementsByTagName("body")[0].appendChild(this.sm2LinkerFrame);this.checkInitStatus()};AxsSound.prototype.checkInitStatus=function(){if(document.location.hash=="#InitSuccess"){this.initSucceeded=true;this.busyInitializing=false;return}if(this.verbosity=="none"&&this.initChecks>0){this.initSucceeded=true;this.busyInitializing=false;return}var self=this;window.setTimeout(function(){self.checkInitStatus()},
100);this.initChecks++};AxsSound.prototype.play=function(url){var playedEarcon=this.playEarcon(url);if(this.earconsOnly||playedEarcon)return;if(!this.initSucceeded){this.init();var self=this;window.setTimeout(function(){self.play(url)},500);return}this.sm2LinkerFrame.src=this.sm2BaseURL+"AxsJAX_SM2_Linker.html#AxsSoundCmd=Play("+url+")"};AxsSound.prototype.stop=function(){if(this.earconsObj){this.earconsObj.parentNode.removeChild(this.earconsObj);this.earconsObj=null}if(this.earconsOnly)return;if(!this.initSucceeded)return;
this.sm2LinkerFrame.src=this.sm2BaseURL+"AxsJAX_SM2_Linker.html#AxsSoundCmd=Stop()"};AxsSound.prototype.getTime=function(){if(this.earconsOnly)return-1;if(!this.initSucceeded)return-1;var timeKeyword="Time=",timeStr=unescape(document.location.hash);if(timeStr.indexOf(timeKeyword)==-1)return-1;var timeStart=timeStr.indexOf(timeKeyword)+timeKeyword.length,time=parseInt(timeStr.substring(timeStart),10);return time};AxsSound.prototype.playEarcon=function(earcon){var earconCMD="";switch(earcon){case "alert":earconCMD=
"alert";break;case "deselect":earconCMD="deselect";break;case "item":earconCMD="item";break;case "list":earconCMD="list";break;case "select":earconCMD="select";break;case "success":earconCMD="success";break;case "wrap":earconCMD="wrap";break;default:}if(earconCMD==="")return;if(this.earconsObj===null){this.earconsObj=document.createElement("embed");this.earconsObj.height=0;this.earconsObj.width=0;document.body.appendChild(this.earconsObj)}this.earconsObj.src=this.earconsSwf+earconCMD};var axsFinance={};axsFinance.str={HELP:"The following shortcut keys are available. ",COMPANY:"Company ",OR:" or ",MARKET_CAP:" market cap ",USD:" US dollars ",VOLUME:" volume ",UP:" up by ",DOWN:" down by ",PRCNT:" percent",MILLION:" million ",BILLION:" billion ",CONSUMERS:"Consumer ",STD_AND_POOR:"Standard and Poor's 500",UP_ABBR:"+",MINUS_ABBR:"-",PRCNT_ABBR:"%",MILLION_ABBR:"M",BILLION_ABBR:"B",GOOGLE_FINANCE:"Google Finance"};axsFinance.charPrefixMap={};axsFinance.charPrefixMap[axsFinance.str.MINUS_ABBR]=
axsFinance.str.DOWN;axsFinance.charPrefixMap[axsFinance.str.UP_ABBR]=axsFinance.str.UP;axsFinance.charSuffixMap={};axsFinance.charSuffixMap[axsFinance.str.BILLION_ABBR]=axsFinance.str.BILLION;axsFinance.charSuffixMap[axsFinance.str.MILLION_ABBR]=axsFinance.str.MILLION;axsFinance.charSuffixMap[axsFinance.str.PRCNT_ABBR]=axsFinance.str.PRCNT;axsFinance.noVolDescArray=new Array(axsFinance.str.COMPANY," ",axsFinance.str.MARKET_CAP,axsFinance.str.USD);axsFinance.volDescArray=new Array(axsFinance.str.COMPANY,
axsFinance.str.VOLUME,axsFinance.str.USD+" "+axsFinance.str.MARKET_CAP,axsFinance.str.USD);axsFinance.IndAndCurDescArray=new Array(""," ","",axsFinance.str.OR,"");axsFinance.recQuotesDescArray=new Array(""," ","",axsFinance.str.OR,axsFinance.str.MARKET_CAP,axsFinance.str.USD);axsFinance.SECT_SUM_TMPL="{0} percent of this sector is down. {1} percent of all the companies are down by more than {2} percent. {3} percent of this sector is up. {4} percent  of all the companies are up by more than {5} percent.";
axsFinance.axsJAXObj=null;axsFinance.axsNavObj=null;axsFinance.axsLensObj=null;axsFinance.magSize=2.5;axsFinance.axsSound=null;axsFinance.searchBoxFocusEnabled=false;axsFinance.init=function(){axsFinance.axsJAXObj=new AxsJAX(true);axsFinance.axsNavObj=new AxsNav(axsFinance.axsJAXObj);document.addEventListener("keypress",axsFinance.keyHandler,true);document.addEventListener("DOMSubtreeModified",axsFinance.DOMSubtreeModifiedHandler,true);var searchBox=document.getElementById("searchbox");searchBox.addEventListener("focus",
axsFinance.searchBoxKeyHandler,false);var cnrString='<cnr next="RIGHT l" prev="LEFT h">  <target title="Go to link" hotkey="ENTER"      onEmpty="No link available">    ./descendant-or-self::a  </target>  <target title="Stock screener" hotkey="s">    //a[@href="/finance/stockscreener"]  </target>  <list title="Market summary" next="DOWN j" prev="UP k"      fwd="n" back="p">    <item index="0" count="1"        action="CALL:axsFinance.handleMarketSummaryDescription">      id("home-main")//div[contains(@class, "news major")]//a    </item>    <item index="1">      id("home-main")//div[contains(@class, "news major")]//a    </item>  </list>  <list title="Market summary indices and currencies"      next="DOWN j" prev="UP k" fwd="n" back="p">    <item action="CALL:axsFinance.readTableRowIndicesAndCurrencies">       id("sfe-mktsumm")//tr[*/*]    </item>  </list>  <list title="Market top stories" next="DOWN j" prev="UP k"      fwd="n" back="p">    <item action="CALL:axsFinance.readMktTopStAndPortfRelTopStDesc">      id("market-news")//span[*]/a[not(@class)] |          id("market-news")/div/div[*]/a    </item>    <target title="Related articles"  hotkey="r"        onEmpty="No related articles available.">      ./../following-sibling::div[@class="g-section          g-tpl-65 sfe-break-bottom" or          @class="byline sfe-break-bottom"]          [1]/descendant::a[@class="more-rel"]    </target>    <target title = "Market top stories" trigger="listEntry">      id("market-news-title")    </target>  </list>  <list title="Portfolio related top stories"      next="DOWN j" prev="UP k" fwd="n" back="p">    <item action="CALL:axsFinance.readMktTopStAndPortfRelTopStDesc">      id("portfolio-news")//span[*]/a[not(@class)]    </item>    <target title="Related articles"  hotkey="r"        onEmpty="No related articles available.">      ./../following-sibling::div[@class="sfe-break-bottom" or          @class="byline sfe-break-bottom"][1]/          descendant::a[@class="more-rel"]    </target>    <target title = "Portfolio related top stories"        trigger="listEntry">      id("portfolio-news-title")    </target>  </list>  <list title="Video top stories" next="DOWN j" prev="UP k" fwd="n"      back="p" type="dynamic">    <item action="CALL:axsFinance.readVideoDesc">      id("video-news")//a    </item>    <target title = "Video top stories" trigger="listEntry">      id("video-news-title")    </target>  </list>  <list title="Recent quotes" next="DOWN j" prev="UP k"      fwd="n" back="p" type="dynamic">    <item action="CALL:axsFinance.readTableRowRecentQuotesDesc">      id("home-main")//table[@class="quotes"]//      td[@class="symbol"]/..[not(@class="colHeader")]    </item>  </list>  <list title="Sector summary" next="DOWN j" prev="UP k"      fwd="n" back="p">    <item action="CALL:axsFinance.readTableRowSectorSummaryDesc">       id("secperf")/table/tbody/tr[not(@class="colHeader")]    </item>  </list>  <list title="Popular trends" next="DOWN j" prev="UP k"      fwd="n" back="p">    <item action="CALL:axsFinance.readTableRowTrendsNoVolumeDesc">       id("tm_zeitgeist")//td[@class="symbol"]/..    </item>    <target title = "Popular trends" trigger="listEntry">      id("l_tm_zeitgeist")    </target>  </list>  <list title="Price trends gainers" next="DOWN j"      prev="UP k" fwd="n" back="p">    <item action="CALL:axsFinance.readTableRowTrendsNoVolumeDesc">      id("tm_price_0")//td[@class="change chg"]/..    </item>    <target title = "Price trends gainers" trigger="listEntry">      id("l_tm_price")    </target>  </list>  <list title="Price trends losers" next="DOWN j" prev="UP k"      fwd="n" back="p">    <item action="CALL:axsFinance.readTableRowTrendsNoVolumeDesc">      id("tm_price_0")//td[@class="change chr"]/..    </item>    <target title = "Price trends losers" trigger="listEntry">      id("l_tm_price")    </target>  </list>  <list title="Market capitalization trends gainers"      next="DOWN j" prev="UP k" fwd="n" back="p">    <item action="CALL:axsFinance.readTableRowTrendsNoVolumeDesc">     id("tm_mcap_0")//td[@class="change chg"]/..    </item>    <target title = "Market capitalization trends gainers"        trigger="listEntry">      id("l_tm_mcap")    </target>  </list>  <list title="Market capitalization trends losers"      next="DOWN j" prev="UP k" fwd="n" back="p">    <item action="CALL:axsFinance.readTableRowTrendsNoVolumeDesc">     id("tm_mcap_0")//td[@class="change chr"]/..    </item>    <target title = "Market capitalization trends losers"         trigger="listEntry">      id("l_tm_mcap")    </target>  </list>  <list title="Volume trends" next="DOWN j" prev="UP k"      fwd="n" back="p">    <item action="CALL:axsFinance.readTableRowTrendsVolumeDesc">      id("tm_volume_0")//td[@class="name"]/.. |          id("tm_volume_0")/div    </item>    <target title = "Volume trends" trigger="listEntry">      id("l_tm_volume")    </target>  </list></cnr>';
axsFinance.axsNavObj.navInit(cnrString,null);axsFinance.axsLensObj=new AxsLens(axsFinance.axsJAXObj);axsFinance.axsNavObj.setLens(axsFinance.axsLensObj);axsFinance.axsSound=new AxsSound(true);axsFinance.axsNavObj.setSound(axsFinance.axsSound);axsFinance.axsLensObj.setMagnification(axsFinance.magSize);document.getElementById("searchbox").blur()};axsFinance.DOMSubtreeModifiedHandler=function(evt){var target=evt.target;if(target.id=="ac-list")for(var i=0,child;child=target.childNodes[i];i++){if(child.className==
"selected"){axsFinance.axsJAXObj.speakNode(child);return}}else target.id=="video-news"&&window.setTimeout(function(){axsFinance.axsNavObj.refreshList("Video top stories")},0)};axsFinance.handleMarketSummaryDescription=function(item){var rootNode=document.getElementById("home-main"),xpath="//div[contains(@class, 'news major')]",newsSectionNode=axsFinance.axsJAXObj.evalXPath(xpath,rootNode)[0];xpath="//span[contains(@class, 'name')]";var headlineNode=axsFinance.axsJAXObj.evalXPath(xpath,newsSectionNode)[0];
xpath="//div[contains(@class, 'byline')]";var bylineNode=axsFinance.axsJAXObj.evalXPath(xpath,newsSectionNode)[0];xpath="//div[contains(@class, 'snippet')]";var snippetNode=axsFinance.axsJAXObj.evalXPath(xpath,newsSectionNode)[0],text=headlineNode.textContent+". "+bylineNode.textContent+". "+snippetNode.textContent+". ";axsFinance.speakAndGo(item.elem,text)};axsFinance.speakAndGo=function(element,text){axsFinance.axsLensObj.view(element);axsFinance.axsJAXObj.speakTextViaNode(text);element.scrollIntoView(true);
axsFinance.axsJAXObj.markPosition(element)};axsFinance.readTableRowIndicesAndCurrencies=function(item){var columns=item.elem.childNodes,index=columns[1].textContent;if(index.indexOf("S&P")!=-1)index=axsFinance.str.STD_AND_POOR;var rate=axsFinance.parseSpecialChars(columns[2].textContent),absoluteChange=axsFinance.parseSpecialChars(columns[3].textContent),relativeChange=columns[4].textContent;if(relativeChange.charAt(1)!="-")relativeChange="+"+relativeChange.substring(1);relativeChange=axsFinance.parseSpecialChars(relativeChange);
var textContents=new Array(index,rate,absoluteChange,relativeChange),rowText=axsFinance.buildTableRowText(textContents,axsFinance.IndAndCurDescArray);axsFinance.speakAndGo(item.elem,rowText)};axsFinance.searchBoxKeyHandler=function(evt){if(!axsFinance.searchBoxFocusEnabled){axsFinance.axsJAXObj.speakTextViaNode(" ");evt.target.blur()}};axsFinance.readMktTopStAndPortfRelTopStDesc=function(item){var element=item.elem,title=element.textContent+". ",parentNode=element.parentNode,xPath='.//following-sibling::div[@class="byline"]',
times=axsFinance.axsJAXObj.evalXPath(xPath,element),time="";if(times[0])time=times[0].textContent;var snippet="";if(parentNode.parentNode.className.indexOf("g-unit")==-1){xPath='.//following-sibling::*//div[@class="snippet"]';var snippets=axsFinance.axsJAXObj.evalXPath(xPath,parentNode);snippet=snippets[0].textContent}var text=title+" "+time+" "+snippet;axsFinance.speakAndGo(element,text)};axsFinance.readVideoDesc=function(item){var element=item.elem,title=element.textContent+". ",parentNode=element.parentNode,
xPath='.//following-sibling::div[@class="byline"]',times=axsFinance.axsJAXObj.evalXPath(xPath,element),time="";if(times[0])time=times[0].textContent;var snippet="";if(parentNode.id=="video-header"){xPath='.//following-sibling::div[@id="video-footer"]';var snippets=axsFinance.axsJAXObj.evalXPath(xPath,parentNode);snippet=snippets[0].textContent}var text=title+" "+time+" "+snippet;axsFinance.speakAndGo(element,text)};axsFinance.readTableRowRecentQuotesDesc=function(item){var columns=item.elem.childNodes,
company=columns[1].textContent,price=axsFinance.parseSpecialChars(columns[2].textContent),absoluteChange=columns[3].childNodes[0].textContent;absoluteChange=axsFinance.parseSpecialChars(absoluteChange);var relativeChange=columns[3].childNodes[2].textContent;if(relativeChange.charAt(1)!="-")relativeChange="+"+relativeChange.substring(1);relativeChange=axsFinance.parseSpecialChars(relativeChange);var marketCap=axsFinance.parseSpecialChars(columns[4].textContent),textContents=new Array(company,price,
absoluteChange,relativeChange,marketCap),rowText=axsFinance.buildTableRowText(textContents,axsFinance.recQuotesDescArray);axsFinance.speakAndGo(item.elem,rowText)};axsFinance.readTableRowSectorSummaryDesc=function(item){var columns=item.elem.childNodes,sector=columns[1].textContent,index=sector.indexOf("Cons.");if(index!=-1)sector=axsFinance.str.CONSUMERS+sector.substring(index+5);var absoluteChange=axsFinance.parseSpecialChars(columns[3].textContent),statusBarTableXPath="./descendant::table/descendant::td[@class]",
downTable=axsFinance.axsJAXObj.evalXPath(statusBarTableXPath,columns[5]),temp=downTable[0].title,downPrcntAboveTreshold=Number(temp.substring(0,temp.indexOf(" ")-1)),treshold=Number(temp.substring(temp.lastIndexOf(" "),temp.length-1));temp=downTable[1].title;var downPrcntBelowTreshold=Number(temp.substring(0,temp.indexOf(" ")-1)),upTable=axsFinance.axsJAXObj.evalXPath(statusBarTableXPath,columns[7]);temp=upTable[0].title;var upPrcntBelowTreshold=Number(temp.substring(0,temp.indexOf(" ")-1));temp=
upTable[1].title;var upPrcntAboveTreshold=Number(temp.substring(0,temp.indexOf(" ")-1)),percentParameters=[];percentParameters[0]=downPrcntAboveTreshold+downPrcntBelowTreshold;percentParameters[1]=downPrcntAboveTreshold;percentParameters[2]=treshold;percentParameters[3]=upPrcntAboveTreshold+upPrcntBelowTreshold;percentParameters[4]=upPrcntAboveTreshold;percentParameters[5]=treshold;var statusBarDesc=axsFinance.populateTemplate(axsFinance.SECT_SUM_TMPL,percentParameters),rowText=sector+" "+absoluteChange+
". "+statusBarDesc;axsFinance.speakAndGo(item.elem,rowText)};axsFinance.populateTemplate=function(template,values){var sentence=new String(template);for(var i=0;i<values.length;i++)sentence=sentence.replace("{"+i+"}",values[i]);return sentence};axsFinance.readTableRowTrendsNoVolumeDesc=function(item){var columnValues=axsFinance.getTableRowContentArray(item),rowText=axsFinance.buildTableRowText(columnValues,axsFinance.noVolDescArray);axsFinance.speakAndGo(item.elem,rowText)};axsFinance.readTableRowTrendsVolumeDesc=
function(item){var columnValues=axsFinance.getTableRowContentArray(item),rowText=axsFinance.buildTableRowText(columnValues,axsFinance.volDescArray);axsFinance.speakAndGo(item.elem,rowText)};axsFinance.getTableRowContentArray=function(item){var columns=item.elem.childNodes,company=columns[1].textContent,absoluteChange=columns[4].textContent;if(absoluteChange.charAt(0)!="-")absoluteChange="+"+absoluteChange;absoluteChange=axsFinance.parseSpecialChars(absoluteChange);var marketCap=axsFinance.parseSpecialChars(columns[5].textContent),
columnValues=new Array(company,absoluteChange,marketCap);return columnValues};axsFinance.buildTableRowText=function(textContents,columnDescriptors){if(textContents===null)return"";var rowText="";for(var i=0,textContent;textContent=textContents[i];i++){if(columnDescriptors!==null&&i<columnDescriptors.length)rowText=rowText+columnDescriptors[i];rowText=rowText+textContents[i]}if(columnDescriptors!==null&&i<columnDescriptors.length)rowText=rowText+columnDescriptors[i];return rowText};axsFinance.parseSpecialChars=
function(text){var parsedText="";if(text==="")return text;text=text.replace(/^\s\s*/,"").replace(/\s\s*$/,"");var tokens=text.split(" ");for(var i=0,t;t=tokens[i];i++){var token=tokens[i];if(token.length>0&&token.charAt(0)==="(")token=token.substring(1);if(token.length>1&&token.charAt(token.length-1)===")")token=token.substring(0,token.length-1);var prefixMapping=axsFinance.charPrefixMap[token.charAt(0)];if(prefixMapping!=undefined)token=prefixMapping+" "+token.substring(1);var lastCharacter=token.charAt(token.length-
1),suffixMapping=axsFinance.charSuffixMap[lastCharacter];if(suffixMapping!=undefined)token=token.substring(0,token.length-1)+" "+suffixMapping;parsedText=parsedText+" "+token}return parsedText};axsFinance.normalizeString=function(text){text=text.replace(/^\s\s*/,"").replace(/\s\s*$/,"");text=text.replace(/\s+/g," ");return text.replace(/\n+/g,"").replace(/\r+/g,"")};axsFinance.keyHandler=function(evt){if(evt.ctrlKey)return true;if(evt.keyCode==27){axsFinance.axsJAXObj.lastFocusedNode.blur();return false}if(axsFinance.axsJAXObj.inputFocused)return true;
var command=axsFinance.charCodeMap[evt.charCode];if(command)return command();return true};axsFinance.charCodeMap={47:function(){axsFinance.searchBoxFocusEnabled=true;document.getElementById("searchbox").focus();document.getElementById("searchbox").select();return false},63:function(){var helpStr=axsFinance.str.HELP+axsFinance.axsNavObj.localHelpString()+axsFinance.axsNavObj.globalHelpString();axsFinance.axsJAXObj.speakTextViaNode(helpStr);return false}};axsFinance.init();
 })();
